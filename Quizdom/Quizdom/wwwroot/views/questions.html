<div id='questions'>
  <div id="filters" class="row">
    <div class="col s12">
      <div class="card indigo lighten-4">
        <div class="card-content black-text">
          <span class="card-title">{{ vm.title }}</span>
          <div class="row">
            <div class="input-field col s5">
              <select name="categorySelect" id="categorySelect" ng-model="vm.category">
                <option value="" selected>Show all</option>
                <option ng-repeat="cat in vm.QuestionService.categories" value={{cat}}>{{cat}}</option>
              </select>
              <label>Category</label>
            </div>
            <div class="input-field col s5 offset-s1">
              <select name="difficultySelect" id="categorySelect" ng-model="vm.difficulty">
                <option value="" selected>Show all</option>
                <option ng-repeat="level in vm.QuestionService.difficulty" value={{level}}>{{level}}</option>
              </select>
              <label>Difficulty</label>
            </div>

          </div>
          <div class="row">
            <div class="col s12 center-align">
              <dir-pagination-controls></dir-pagination-controls>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <ul id='question-list' class="collapsible popout" data-collapsible="accordion" watch>
      <li ng-cloak dir-paginate="q in vm.questions | filter: vm.category | filter: vm.difficulty | itemsPerPage: 10">
        <div class="collapsible-header">
          <div class="col s1">{{ q.id }}.</div>
          <div>{{ q.question }}</div>
        </div>
        <div class="collapsible-body">
          <ul id="answer-list" class="collection">
            <li class="collection-item row"><span class="col s1">A.</span>{{ q.correct_Answer }}<span class="new badge green" data-badge-caption="Right"></span></li>
            <li class="collection-item row" ng-repeat="a in [q.incorrect_Answer1, q.incorrect_Answer2, q.incorrect_Answer3]"><span class="col s1">{{ "BCD"[$index] }}.</span>{{ a }}<span class="new badge red" data-badge-caption="Wrong"></span></li>
          </ul>
          <div class="row" style="position: relative; height: 48px;">
            <span>{{ q.category }}: {{ q.difficulty }}</span>
            <div class="" style="position: absolute; display: inline-block; right: 24px; bottom: 0;">
              <a id="edit-question" class="btn-floating orange" href="#question-modal" ng-click="vm.editQuestion(q.id)">
                <i class="large material-icons">mode_edit</i>
              </a>
            </div>
          </div>
        </div>
      </li>
    </ul>
  </div>
  <div id="question-modal" class="modal modal-fixed-footer">
    <div class="modal-content">
      <div class="row">
        <div class="col s1">{{ vm.questionToEdit.id }}.</div>
        <div class="input-field col s11">
          <textarea id="question-text" class="materialize-textarea validate" required data-error="wrong" ng-model="vm.questionToEdit.question"></textarea>
          <label for="question-text">Question Wording</label>
          <a class="modal-action modal-close btn-floating right orange" style="display: inline-block; position: relative; top: -20px; right: -5px"><i class="material-icons large">cancel</i></a>
        </div>
      </div>
      <div class="row">
        <div class="col s1 offset-s1">A.</div>
        <div class="input-field col s10">
          <input type="text" id="correct-answer" class="validate" required data-error="wrong" ng-model="vm.questionToEdit.correct_Answer">
          <label for="correct-answer" class="green-text">Correct Answer</label>
        </div>
      </div>
      <div class="row">
        <div class="col s1 offset-s1">B.</div>
        <div class="input-field col s10">
          <input type="text" id="incorrect-answer1" class="validate" required data-error="wrong" ng-model="vm.questionToEdit.incorrect_Answer1">
          <label for="incorrect-answer1" class="red-text">Wrong Answer</label>
        </div>
      </div>
      <div class="row">
        <div class="col s1 offset-s1">C.</div>
        <div class="input-field col s10">
          <input type="text" id="incorrect-answer2" class="validate" required data-error="wrong" ng-model="vm.questionToEdit.incorrect_Answer2">
          <label for="incorrect-answer1" class="red-text">Wrong Answer</label>
        </div>
      </div>
      <div class="row">
        <div class="col s1 offset-s1">D.</div>
        <div class="input-field col s10">
          <input type="text" id="incorrect-answer3" class="validate" required data-error="wrong" ng-model="vm.questionToEdit.incorrect_Answer3">
          <label for="incorrect-answer1" class="red-text">Wrong Answer</label>
        </div>
      </div>
      <div class="row">
        <div class="input-field col s5">
          <select name="questionCategory" id="questionCategory" required ng-model="vm.questionToEdit.category">
            <option value="" disabled>Change</option>
            <option ng-repeat="cat in vm.QuestionService.categories" value={{cat}}>{{cat}}</option>
          </select>
          <label>Category: {{ vm.questionToEdit.category }}</label>
        </div>
        <div class="input-field col s5 offset-s1">
          <select name="questionDifficulty" id="questionDifficulty" required ng-model="vm.questionToEdit.difficulty">
            <option value="" disabled>Change</option>
            <option ng-repeat="level in vm.QuestionService.difficulty" value={{level}}>{{level}}</option>
          </select>
          <label>Difficulty: {{ vm.questionToEdit.difficulty }}</label>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <a class="btn red left"><i class="material-icons left">delete</i>Delete</a>
      <a class="modal-action modal-close green btn" ng-click="vm.saveQuestion(vm.questionToEdit)"><i class="material-icons left">assignment_returned</i>Save</a>
    </div>
  </div>
</div>

<script>
  $(document).ready(function () {
    $('select').material_select();
    $('.collapsible').collapsible();
    $('.modal').modal({
      ready: function (modal, trigger) {
        Materialize.updateTextFields();
      }
    });
    $('.modal').modal('close');
  });
  $('#question-modal').modal('open');
</script>